# dhcp-inform plugin configuration
# Responds to DHCPINFORM from Windows VPN clients with split-tunnel routes
#
# THREE MUTUALLY EXCLUSIVE MODES (priority order):
# 1. Traffic Selectors - when use_ts_routes=yes
# 2. Database - when database URI configured
# 3. Static configuration - when no database
#
# Modes are EXCLUSIVE - only the highest-priority configured mode is used.
# If multiple modes are configured, lower-priority modes are silently ignored.

dhcp-inform {
    # Enable the plugin
    load = yes

    # Server IP address (required - usually the VPN gateway IP)
    server = 172.16.69.1

    # VPN interface to listen on (optional, listens on all if not set)
    # interface = eth0

    # DNS server to advertise (optional)
    # dns = 172.16.69.1

    # =========================================================================
    # MODE 1: Traffic Selector Routes (EXCLUSIVE)
    # =========================================================================
    # Routes are extracted from IKE SA traffic selectors.
    # Designed for Windows 7 compatibility (doesn't handle TS properly).
    # When enabled, database and static routes are IGNORED.
    #
    # use_ts_routes = yes

    # =========================================================================
    # MODE 2: Database Routes (EXCLUSIVE)
    # =========================================================================
    # Routes are queried from database by matching client IP to pool CIDR.
    # When database is configured, static routes are IGNORED.
    # Works with PostgreSQL, MySQL, SQLite via strongSwan database abstraction.
    #
    # Requires VIEW v_pool_routes (pool_cidr TEXT, route TEXT):
    #   - pool_cidr: CIDR notation (e.g., "10.0.0.0/8")
    #   - route: route to push to clients in this pool
    #
    # database = pgsql://vpn_user:password@localhost/vpn_db
    # database = mysql://vpn_user:password@localhost/vpn_db
    # database = sqlite:///etc/strongswan/routes.db

    # =========================================================================
    # MODE 3: Static Routes (EXCLUSIVE - only when no database)
    # =========================================================================
    # Used ONLY when no database is configured.
    #
    # Global routes - apply to all clients not matching a specific pool:
    #
    # routes {
    #     route1 = 10.0.0.0/8
    #     route2 = 172.16.0.0/12
    #     route3 = 192.168.0.0/16
    # }
    #
    # Per-pool route overrides - clients matching pool CIDR get these instead:
    #
    # pools {
    #     production {
    #         cidr = 10.100.0.0/16
    #         routes {
    #             r1 = 192.168.1.0/24
    #             r2 = 192.168.2.0/24
    #         }
    #     }
    #     development {
    #         cidr = 10.200.0.0/16
    #         routes {
    #             r1 = 10.50.0.0/16
    #         }
    #     }
    # }
}
